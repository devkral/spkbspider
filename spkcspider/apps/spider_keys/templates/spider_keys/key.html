{% load i18n %}

<div class="w3-padding">
  {% if object.free_data.thirdparty %}
    <div class="w3-red w3-jumbo">
      {% trans 'Warning: key doesn\'t belong to user, use only for rencrypting encrypted content' %}
    </div>
    <data hidden="hidden" typeof="spkc:Property">
      <data hidden="hidden" property="spkc:name" datatype="xsd:string">thirdparty</data>
      <data hidden="hidden" property="spkc:hashable" datatype="xsd:boolean">false</data>
      <span property="spkc:value" datatype="xsd:boolean">true</span>
    </td>
  {% endif %}
  <h1>{% trans 'Key & hash' %}</h1>
  <table>
    <tr>
      <td>{% trans 'Hash algorithm' %}</td>
      <td class="w3-white w3-padding" typeof="spkc:Property">
        <data hidden="hidden" property="spkc:name" datatype="xsd:string">hash_algorithm</data>
        <data hidden="hidden" property="spkc:hashable" datatype="xsd:boolean">false</data>
        <span property="spkc:value" datatype="xsd:string">{{hash_algo}}</span>
      </td>
    </tr>
    <tr>
      <td>{% trans 'Hash' %}</td>
      <td class="w3-white w3-padding" style="word-break: break-all">
        {{hash}}
      </td>
    </tr>
    <tr>
      <td>{% trans 'Hash of public key' %}</td>
      {% if pubkeyhash %}
      <td class="w3-white w3-padding" style="word-break: break-all">
        {{pubkeyhash}}
      </td>
      {% else %}
        <td class="w3-white w3-padding">{% trans 'No Public Key could be extracted' %}</td>
      {% endif %}
    </tr>
    <tr style="margin-top:5px">
      <td>{% trans 'key' %}</td>
      <td class="w3-white w3-padding" style="word-break: break-all" typeof="spkc:Property">
        <data hidden="hidden" property="spkc:name" datatype="xsd:string">key</data>
        <data hidden="hidden" property="spkc:hashable" datatype="xsd:boolean">{% if object.free_data.thirdparty %}false{% else %}true{% endif %}</data>
        <pre style="white-space: pre-wrap;" property="spkc:value" datatype="xsd:string">{{key}}</pre>
      </td>
    </tr>
  </table>
</div>
